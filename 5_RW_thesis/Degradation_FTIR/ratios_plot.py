import matplotlib.pyplot as plt

#Ratios
#LC = [[[20.31249999999995, 25.092348801553452, 33.080356633021744, 41.24302378036121], [3.1322115384615414, 8.83852603938361, 8.540524350280174, 11.295700664640187], [25.550480769230706, 30.289310486941005, 37.92594797133513, 51.11138918438155], [0.9471153846153918, 2.450816759716521, 1.8779323310097489, 3.646974562812011], [24.759615384615316, 30.171155609308297, 37.32073533734833, 50.83062305445437]], [[0.0, 7.902078269160528, 8.48033201509093, 13.452472612463314], [4.440892098500626e-16, 2.312011417460884, 2.3316066693983015, 3.053817188529911], [0.0, 9.909117886906596, 9.565718789620947, 14.991589140520952], [1.1102230246251565e-16, 0.959053280364334, 0.4799422706870801, 0.43535603490306823], [0.0, 9.86822852663532, 9.355281963964481, 14.674491592673128]], [['', '', '', ''], ['', '*', '*', '*'], ['', '', '', ''], ['', '', '', '*'], ['', '', '', '']]]
#PET1 = [[[56.43277182031644, 48.24270187046775, 126.30893382586562, 112.72469120026993], [-0.48414626013663015, 1.4123946307494935, 4.907886362182062, 4.211685407615526], [59.42035718096519, 50.4844130409172, 132.26575273458346, 117.9767867791096], [0.19783197289797694, 0.39548482944578467, 0.5329431331158568, 0.5310908084163971], [57.996526888604954, 49.24338088038943, 129.24400227082128, 115.03397009966507]], [[22.71509597641319, 10.250394477149348, 82.21011247174627, 5.6501156106356625], [1.7246556200547387, 0.22124684521009, 2.8662911459121796, 0.283586532422518], [22.954021995676296, 10.590542903784817, 87.05835073818882, 5.490760394979528], [0.7230704692932887, 0.13792915251480062, 0.03433668130531724, 0.14945730136355695], [22.367540223377837, 10.18215348496744, 85.17097943173441, 5.002519748874809]], [['', '', '', '*'], ['', '', '', '*'], ['', '', '', '*'], ['', '', '', ''], ['', '', '', '*']]]
#PET2 = [[[1302.4157894731186, 271.5482082488153, 168.65842385734865, 136.8754992319408], [43.07894736840248, 9.236747802569207, 5.70890209742436, 5.066359447004249], [1355.3005847947336, 284.04550371872733, 177.30031199471742, 146.21428571427498], [0.4631578947373051, 0.8136240703178149, 0.5641490742638552, 0.5966205837173223], [1326.5549707596583, 276.4825219743056, 172.7835849787078, 143.1181259600509]], [[1059.8339253247345, 127.05797267740135, 115.46076705410786, 21.73833432141522], [33.65060686771691, 4.3998274665093575, 4.044804577766663, 1.2174066871075702], [1102.110315160371, 133.98621992460292, 121.17114062180947, 25.110393002387266], [2.7043004635618435, 0.33466507132055984, 0.5982350636686298, 0.439792699091906], [1077.7996692775728, 130.62297484573583, 117.75164970119535, 24.859418184291663]], [['', '', '', ''], ['', '', '', ''], ['', '', '', ''], ['', '', '', ''], ['', '', '', '']]]

#Differences
LC = [[[26.78, 39.72777777777778, 45.36555555555555, 35.57111111111111], [2.9566666666666777, 13.110000000000005, 10.567777777777778, 9.136666666666665], [34.04333333333334, 48.14444444444445, 52.25555555555555, 44.533333333333324], [-0.07333333333332348, 2.0944444444444485, 1.2144444444444389, 2.4377777777777774], [32.94666666666666, 47.97666666666667, 51.41777777777778, 44.31222222222221]], [[0.0, 2.1033770612347147, 4.989598316300093, 7.7789851443837525], [0.0, 1.2101821105687915, 0.9997975103631683, 1.66089890877957], [0.0, 2.2603938256227774, 4.9711794064746915, 8.044728202484645], [0.0, 0.7358408308833201, 0.4652703979514212, 0.4967027081131039], [0.0, 2.3891064500414445, 4.840083664209042, 7.790916521623984]], [['', '*', '*', ''], ['', '*', '*', '*'], ['', '*', '*', ''], ['', '*', '*', '*'], ['', '*', '*', '']]]
PET1 = [[[26.524444444444445, 29.095555555555563, 25.912222222222216, 32.318888888888885], [-0.8577777777777698, 0.23444444444444437, 0.7555555555555552, 0.9233333333333226], [28.20555555555556, 30.42555555555555, 27.157777777777767, 33.77222222222222], [-0.3077777777777726, -0.37333333333333957, -0.14888888888889085, -0.13777777777778036], [27.53, 29.676666666666666, 26.537777777777773, 32.911111111111104]], [[4.547432595418706, 5.247766603135821, 5.763940481696798, 5.488163919734591], [0.8366615021236459, 0.07494854201796346, 0.12341838908943915, 0.13695092389449373], [4.34083140469088, 4.9340369868551255, 6.421457278550323, 5.3423897644276845], [0.2622033891542039, 0.08055363982395837, 0.09318771709449337, 0.05852086258784639], [4.2401633441631885, 4.762529673281727, 6.333002525473544, 5.121451135019745]], [['', '', '', ''], ['', '', '', '*'], ['', '', '', ''], ['', '', '', ''], ['', '', '', '']]]
PET2 = [[[25.539999999999996, 28.86777777777777, 29.728888888888893, 25.268888888888885], [0.8988888888888861, 0.9988888888888852, 0.9377777777777823, 0.892222222222216], [26.603333333333335, 30.116666666666656, 31.334444444444443, 26.917777777777786], [0.08222222222222797, 0.1311111111111103, 0.024444444444445896, 0.06111111111111237], [26.047777777777778, 29.305555555555546, 30.584444444444447, 26.334444444444443]], [[1.6977130586850213, 1.5757522209181178, 1.0334635521295594, 3.032096613985639], [0.020608041101116022, 0.15341382750304958, 0.15715840872221787, 0.1508085205700949], [1.7263470317621825, 1.5107246237779013, 0.7578347974637477, 3.1070878747998742], [0.07410369778014149, 0.17847778849944496, 0.18103270286380346, 0.13098864336788477], [1.6810960563326878, 1.4674879855229832, 0.6500845149234235, 3.0119297780084997]], [['', '', '*', ''], ['', '', '', ''], ['', '', '*', ''], ['', '', '', ''], ['', '', '*', '']]]


plt.figure(figsize=(10,10))
ax1 = plt.subplot2grid((14,2), (0,0), rowspan=6)
ax1.set_title('A', loc='left')
ax1.set_title('Amorphous PET pieces')
ax2b = plt.subplot2grid((14,2), (0,1), rowspan=6)
ax2b.set_title('B', loc='left')
ax2b.set_title('Weathered PET powder')
ax3c = plt.subplot2grid((14,2), (8,0), rowspan=6)
ax3c.set_title('C', loc='left')
ax3c.set_title('PET powder')

ax1.set_ylim([0,62])
ax2b.set_ylim([-5, 40])
ax3c.set_ylim([-2, 35])


"""
ax2a = plt.subplot2grid((14,2), (3,1), rowspan=3)
ax3b = plt.subplot2grid((14,2), (10,0), rowspan=2)
ax3a = plt.subplot2grid((14,2), (12,0), rowspan=2)
ax2b.set_ylim([10,230])
ax2a.set_ylim([0,8])
ax3c.set_ylim([500, 2600])
ax3b.set_ylim([15, 500])
ax3a.set_ylim([0,15])

def remove(xy, ax):
    if xy == 'x':
        ax.tick_params(axis='x',which='both',top='off', bottom='off')
        plt.setp(ax.get_xticklabels(), visible=False)
    elif xy == 'y':
        ax.tick_params(axis='y',which='both',left='off', right='off')
        plt.setp(ax.get_yticklabels(), visible=False)
    return
remove('x', ax2b)
remove('x', ax3c)
remove('x', ax3b)

ax2b.spines['bottom'].set_visible(False)
ax2a.spines['top'].set_visible(False)

ax3c.spines['bottom'].set_visible(False)
ax3b.spines['bottom'].set_visible(False)
ax3b.spines['top'].set_visible(False)
ax3a.spines['top'].set_visible(False)

d = .015
kwargs = dict(transform=ax2b.transAxes, color='k', clip_on=False)
ax2b.plot((-d, +d), (-d, +d), **kwargs)
ax2b.plot((1 - d, 1 + d), (-d, +d), **kwargs)
kwargs.update(transform=ax2a.transAxes)
ax2a.plot((-d, +d), (1 - d, 1 + d), **kwargs)
ax2a.plot((1 - d, 1 + d), (1 - d, 1 + d), **kwargs)

kwargs = dict(transform=ax3c.transAxes, color='k', clip_on=False)
ax3c.plot((-d, +d), (-d, +d), **kwargs)
ax3c.plot((1 - d, 1 + d), (-d, +d), **kwargs)
kwargs.update(transform=ax3b.transAxes)
ax3b.plot((-d, +d), (1 - d, 1 + d), **kwargs)
ax3b.plot((1 - d, 1 + d), (1 - d, 1 + d), **kwargs)
ax3b.plot((-d, +d), (-d, +d), **kwargs)
ax3b.plot((1 - d, 1 + d), (-d, +d), **kwargs)
kwargs.update(transform=ax3a.transAxes)
ax3a.plot((-d, +d), (1 - d, 1 + d), **kwargs)
ax3a.plot((1 - d, 1 + d), (1 - d, 1 + d), **kwargs)
"""

labels = ['Control', r'$Thioclava$ sp. BHET1', r'$Bacillus$ sp. BHET2', 'Community']
colors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728']
x = [1, 2, 3, 4]
xplc = 2.5
xlabs = []       
          
for a in range(len(LC[0])):
    if a == 0:
        for b in range(len(LC[0][a])):
            ax1.bar(x[b], LC[0][a][b], yerr=LC[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
            #ax2a.bar(x[b], PET1[0][a][b], yerr=PET1[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
            ax2b.bar(x[b], PET1[0][a][b], yerr=PET1[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
            #ax3a.bar(x[b], PET2[0][a][b], yerr=PET2[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
            #ax3b.bar(x[b], PET2[0][a][b], yerr=PET2[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
            ax3c.bar(x[b], PET2[0][a][b], yerr=PET2[1][a][b], capsize=2, label=labels[b], color=colors[b], width=0.8)
    else:
        ax1.bar(x, LC[0][a], yerr=LC[1][a], capsize=2, color=colors, width=0.8)
        #ax2a.bar(x, PET1[0][a], yerr=PET1[1][a], capsize=2, color=colors, width=0.8)
        ax2b.bar(x, PET1[0][a], yerr=PET1[1][a], capsize=2, color=colors, width=0.8)
        #ax3a.bar(x, PET2[0][a], yerr=PET2[1][a], capsize=2, color=colors, width=0.8)
        #ax3b.bar(x, PET2[0][a], yerr=PET2[1][a], capsize=2, color=colors, width=0.8)
        ax3c.bar(x, PET2[0][a], yerr=PET2[1][a], capsize=2, color=colors, width=0.8)
    ttxt_LC, ttxt_PET1, ttxt_PET2 = [], [], []
    for b in range(len(LC[0][a])):
        ttxt_LC.append(LC[0][a][b]+LC[1][a][b]+0.5)
        ttxt_PET1.append(PET1[0][a][b]+PET1[1][a][b]+0.5)
        ttxt_PET2.append(PET2[0][a][b]+PET2[1][a][b]+0.5)
    for b in range(len(LC[2][a])):
        ax1.text(x[b], ttxt_LC[b], LC[2][a][b], ha='center', va='bottom')
        """
        if ttxt_PET1[b] < 20:
            ax2a.text(x[b], ttxt_PET1[b], PET1[2][a][b], ha='center', va='bottom')
        else:
        """
        ax2b.text(x[b], ttxt_PET1[b], PET1[2][a][b], ha='center', va='bottom')
        #ax3a.text(x[b], ttxt_PET2[b], PET2[2][a][b], ha='center', va='bottom')
        #ax3b.text(x[b], ttxt_PET2[b], PET2[2][a][b], ha='center', va='bottom')
        ax3c.text(x[b], ttxt_PET2[b], PET2[2][a][b], ha='center', va='bottom')
    for b in range(len(x)):
        x[b] += 5
    xlabs.append(xplc)
    xplc += 5

ax3c.legend(bbox_to_anchor=(1.1, 1.1))

bonds = ['C=O\n1710 cm$^{-1}$', 'O-H\n2920 cm$^{-1}$\ncarboxylic acid', 'C-O\n1235 cm$^{-1}$', 'O-H\n3300 cm$^{-1}$\n                  alcohol', 'C-O\n1090 cm$^{-1}$\n']
plt.sca(ax1)
plt.xticks(xlabs, bonds, fontsize=8)
plt.ylabel('Difference between wavelength\nand reference 2500 cm$^{-1}$')
#plt.sca(ax2a)
plt.sca(ax2b)
plt.xticks(xlabs, bonds, fontsize=8)
plt.ylabel('Difference between wavelength\nand reference 2500 cm$^{-1}$')
#plt.text(-4, 8.2, 'Ratio between wavelengths', va='center', rotation=90)
#plt.sca(ax3a)
#plt.xticks(xlabs, bonds, fontsize=8)
plt.sca(ax3c)
plt.xticks(xlabs, bonds, fontsize=8)
plt.ylabel('Difference between wavelength\nand reference 2500 cm$^{-1}$')

plt.subplots_adjust(wspace=0.25)
plt.savefig('Combined differences.png', dpi=300)